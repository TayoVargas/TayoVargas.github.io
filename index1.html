<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nuestra Realidad ‚ù§Ô∏è</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

body{
margin:0;
background:#0a0715;
color:white;
font-family:'Poppins',sans-serif;
overflow:hidden;
}

.screen{
position:absolute;
width:100%;
height:100%;
display:none;
flex-direction:column;
justify-content:center;
align-items:center;
text-align:center;
padding:20px;
}

.active{display:flex;}

button{
padding:12px 20px;
border:none;
border-radius:30px;
background:#ff4081;
color:white;
margin:10px;
cursor:pointer;
}

.photo{
width:230px;
border-radius:15px;
margin:10px;
}

#noBtn{position:absolute;}

.heart{
position:fixed;
bottom:-20px;
animation:up 6s linear forwards;
font-size:20px;
}

@keyframes up{
0%{transform:translateY(0);opacity:1;}
100%{transform:translateY(-110vh);opacity:0;}
}
</style>
</head>

<body>

<audio id="music" loop></audio>

<div id="loader" class="screen active">
<h1>Cargando nuestra realidad‚Ä¶ ‚ù§Ô∏è</h1>
<p id="loadText"></p>
</div>

<div id="main" class="screen">
<h1 id="title"></h1>
<button onclick="next('cap1')">Entrar</button>
</div>

<div id="cap1" class="screen">
<h2>Cap√≠tulo 1 ‚ù§Ô∏è El inicio</h2>
<p>Todo comenz√≥ como algo peque√±o‚Ä¶</p>
<button onclick="nextCap(2)">Continuar</button>
</div>

<div id="cap2" class="screen">
<h2>Cap√≠tulo 2 ‚ú® Nuestra conexi√≥n</h2>
<p>Cada d√≠a creci√≥ m√°s‚Ä¶</p>
<img id="photo" class="photo">
<button onclick="nextCap(3)">Continuar</button>
</div>

<div id="cap3" class="screen">
<h2>Cap√≠tulo 3 üåô Recuerdos vivos</h2>
<p>Y floreci√≥ d√≠a tras d√≠a</p>
<canvas id="tree" width="300" height="350"></canvas>
<button onclick="nextCap(4)">Continuar</button>
</div>

<div id="cap4" class="screen">
<h2>Cap√≠tulo 4 üí´ Futuro juntos</h2>
<p>Hasta convertirse en nuestra realidad.</p>
<button onclick="next('proposal')">Continuar</button>
</div>

<div id="proposal" class="screen">
<h1>¬øSeguimos escribiendo esta realidad juntos? üíç</h1>
<button onclick="yes()">S√≠ ‚ù§Ô∏è</button>
<button id="noBtn" onmouseover="escapeNo()">No üòÖ</button>
</div>

<script>

/* PERSONALIZA */
const NOMBRE_DESTINATARIO="Mi Amor ‚ù§Ô∏è";
const FOTO="foto.jpg";
const MUSICA="cancion.mp3";
const FECHA_INICIO="2023-12-31";

/* ELEMENTOS */
const title=document.getElementById("title");
const photo=document.getElementById("photo");
const music=document.getElementById("music");
const loadText=document.getElementById("loadText");
const tree=document.getElementById("tree");
const noBtn=document.getElementById("noBtn");

title.innerText=`Te amo mucho, ${NOMBRE_DESTINATARIO}`;
photo.src=FOTO;
music.src=MUSICA;

/* AUDIO M√ìVIL */
document.body.addEventListener("click",()=>{
music.play().catch(()=>{});
},{once:true});

/* LOADER */
const loadLines=[
"Reuniendo recuerdos‚Ä¶",
"Sincronizando corazones‚Ä¶",
"Preparando cap√≠tulos‚Ä¶"
];

let li=0,ci=0;

function loaderType(){
if(li<loadLines.length){
if(ci<loadLines[li].length){
loadText.innerHTML+=loadLines[li][ci];
ci++;
setTimeout(loaderType,40);
}else{
loadText.innerHTML+="<br>";
li++;ci=0;
setTimeout(loaderType,400);
}
}else setTimeout(()=>next('main'),1000);
}
loaderType();

/* NAVEGACI√ìN */
function next(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');

if(id==="cap3") startTree();
}

/* CAP√çTULOS */
function daysSince(date){
return Math.floor((new Date()-new Date(date))/(1000*60*60*24));
}

function nextCap(n){
if(daysSince(FECHA_INICIO)>=n-1){
next("cap"+n);
}else{
alert("Este cap√≠tulo a√∫n no se desbloquea ‚ù§Ô∏è");
}
}

/* üå≥ √ÅRBOL VIVO */
const ctx=tree.getContext('2d');

function drawHeart(x,y,size){
ctx.save();
ctx.translate(x,y);
ctx.scale(size,size);
ctx.beginPath();
ctx.moveTo(0,0);
ctx.bezierCurveTo(-10,-10,-20,10,0,20);
ctx.bezierCurveTo(20,10,10,-10,0,0);
ctx.fillStyle="#ff4081";
ctx.fill();
ctx.restore();
}

function growBranch(x,y,len,angle,width){
ctx.beginPath();
ctx.lineWidth=width;
ctx.moveTo(x,y);

const x2=x+len*Math.cos(angle);
const y2=y-len*Math.sin(angle);

ctx.lineTo(x2,y2);
ctx.stroke();

if(len<8){
setTimeout(()=>drawHeart(x2,y2,0.3+Math.random()*0.3),200);
return;
}

setTimeout(()=>{
growBranch(x2,y2,len*0.75,angle-0.4,width*0.7);
growBranch(x2,y2,len*0.75,angle+0.4,width*0.7);
},200);
}

function startTree(){
ctx.clearRect(0,0,tree.width,tree.height);
growBranch(150,340,80,Math.PI/2,8);
}

/* PROPUESTA */
function escapeNo(){
noBtn.style.top=Math.random()*200-100+"px";
noBtn.style.left=Math.random()*200-100+"px";
}

function yes(){
for(let i=0;i<150;i++){
setTimeout(()=>{
const h=document.createElement("div");
h.className="heart";
h.innerText="‚ù§Ô∏è";
h.style.left=Math.random()*100+"%";
document.body.appendChild(h);
},i*20);
}
alert("Nuestra realidad apenas comienza ‚ù§Ô∏è");
}

</script>
</body>
</html>